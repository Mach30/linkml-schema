id: command
name: command

classes:
  Command:
    slots:
      - arguments
      - options

  UnixCommand:
    implements:
      - cmd:Command

  Chain:
    attributes:
      description:
      upstream:
        range: UnixCommand
      downstream:
        range: UnixCommand
      bindings:
    examples:
      - object:
          description: pipe grep through wc
          upstream:
            type: Grep
            pattern: foo
          downstream:
            type: WC
            line_count: true


  Grep:
    is_a: UnixCommand
    description: A grep command
    attributes:
      pattern:
      input:
        range: FileObjectSpecifier
      output:
        range: ReportText
    annotations:
      command.template: "grep {pattern} {input}"

  WC:
    is_a: UnixCommand
    description: A word count command
    attributes:
      input:
        range: FileObjectSpecifier
      line_count:
        range: boolean
        annotations:
          shorthand: l
    annotations:
      command.template: "wc {input} {arguments}"
    examples:
      - object:
          description: count lines in foo.txt
          input: foo.txt
      - object:
          description: "pipe grep through wc -l"
          stdin:
            - type: Grep
              pattern: foo
              input: bar.txt
          line_count: true
      - object:
          description: "wc all files generated by upstreams"
          line_count: true
          input:
            - type: TextFile
              path: f1.txt
              command:
                - type: SomeProcess
                  input: g1.txt
                  output: f1.txt
            - type: TextFile
              path: f2.txt
              command:
                - type: SomeProcess
                  input: g2.txt
                  output: f2.txt
